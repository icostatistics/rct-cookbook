<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Dichotomous endpoints | Analyzing RCTs: A Cookbook</title>
  <meta name="description" content="The idea of this book is to capture some of the standard statistical analysis methods for randomised controlled trials" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Dichotomous endpoints | Analyzing RCTs: A Cookbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The idea of this book is to capture some of the standard statistical analysis methods for randomised controlled trials" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Dichotomous endpoints | Analyzing RCTs: A Cookbook" />
  
  <meta name="twitter:description" content="The idea of this book is to capture some of the standard statistical analysis methods for randomised controlled trials" />
  

<meta name="author" content="Inge Christoffer Olsen" />


<meta name="date" content="2019-08-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="continuous-endpoints.html">
<link rel="next" href="applications.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i><b>1.1</b> Structure of the book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#trial-flow"><i class="fa fa-check"></i><b>2.1</b> Trial Flow</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#simulated-dataset"><i class="fa fa-check"></i><b>2.2</b> Simulated dataset</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html"><i class="fa fa-check"></i><b>3</b> Continuous endpoints</a><ul>
<li class="chapter" data-level="3.1" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#single-follow-up"><i class="fa fa-check"></i><b>3.1</b> Single follow-up</a><ul>
<li class="chapter" data-level="3.1.1" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#stata-code"><i class="fa fa-check"></i><b>3.1.1</b> Stata code</a></li>
<li class="chapter" data-level="3.1.2" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#r-code"><i class="fa fa-check"></i><b>3.1.2</b> R code</a></li>
<li class="chapter" data-level="3.1.3" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#reporting"><i class="fa fa-check"></i><b>3.1.3</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#repeated-follow-up"><i class="fa fa-check"></i><b>3.2</b> Repeated follow-up</a><ul>
<li class="chapter" data-level="3.2.1" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#simple-model"><i class="fa fa-check"></i><b>3.2.1</b> Simple model</a></li>
<li class="chapter" data-level="3.2.2" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#model-with-treatment-time-interaction"><i class="fa fa-check"></i><b>3.2.2</b> Model with treatment-time interaction</a></li>
<li class="chapter" data-level="3.2.3" data-path="continuous-endpoints.html"><a href="continuous-endpoints.html#model-with-treatment-time-interaction-and-baseline-information"><i class="fa fa-check"></i><b>3.2.3</b> Model with treatment-time interaction and baseline information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html"><i class="fa fa-check"></i><b>4</b> Dichotomous endpoints</a><ul>
<li class="chapter" data-level="4.1" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#single-follow-up-1"><i class="fa fa-check"></i><b>4.1</b> Single follow-up</a><ul>
<li class="chapter" data-level="4.1.1" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#stata-code-1"><i class="fa fa-check"></i><b>4.1.1</b> Stata code</a></li>
<li class="chapter" data-level="4.1.2" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#r-code-1"><i class="fa fa-check"></i><b>4.1.2</b> R code</a></li>
<li class="chapter" data-level="4.1.3" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#reporting-1"><i class="fa fa-check"></i><b>4.1.3</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#repeated-follow-up-1"><i class="fa fa-check"></i><b>4.2</b> Repeated follow-up</a></li>
<li class="chapter" data-level="4.3" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#treatment-time-interaction-model"><i class="fa fa-check"></i><b>4.3</b> Treatment-time interaction model</a><ul>
<li class="chapter" data-level="4.3.1" data-path="dichotomous-endpoints.html"><a href="dichotomous-endpoints.html#reporting-2"><i class="fa fa-check"></i><b>4.3.1</b> Reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyzing RCTs: A Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dichotomous-endpoints" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Dichotomous endpoints</h1>
<div id="single-follow-up-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Single follow-up</h2>
<p>For a single follow-up assessment of a dichotomous endpoint, the main method I use is a standard logistic regression. Then we can adjust for stratification factors in the randomisation in addition to other pre-specified covariates, both categorical and continuous. In the simulated example, we define that the primary outcome is the dichotomous categorical outcome at time 3. Note that usually the baseline status of all patients are negative for the outcome, so adjusting for baseline is not necessary.</p>
<div id="stata-code-1" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Stata code</h3>
<pre class="stata"><code>use &quot;stata/rct&quot;, clear 
tabulate catout trt if time == 3, column
logistic catout i.trt i.site covar  if time==3, coef</code></pre>
<pre><code>## 
## . use &quot;stata/rct&quot;, cle(all strata combined)
## 
## . tabulate catout trt if time == 3, column
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |         9         22 |        31 
##            |     18.00      45.83 |     31.63 
## -----------+----------------------+----------
##   Positive |        41         26 |        67 
##            |     82.00      54.17 |     68.37 
## -----------+----------------------+----------
##      Total |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## 
## . logistic catout i.trt i.site covar  if time==3, coef
## 
## Logistic regression                             Number of obs     =         98
##                                                 LR chi2(5)        =      48.59
##                                                 Prob &gt; chi2       =     0.0000
## Log likelihood = -36.862204                     Pseudo R2         =     0.3973
## 
## ------------------------------------------------------------------------------
##       catout |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##          trt |
##      Active  |  -2.890301   .7850252    -3.68   0.000    -4.428922   -1.351679
##              |
##         site |
##           2  |   .7783404   .8580245     0.91   0.364    -.9033566    2.460037
##           3  |   1.423791   .7786531     1.83   0.067    -.1023412    2.949923
##           4  |   .0253234   .8082887     0.03   0.975    -1.558893     1.60954
##              |
##        covar |   1.001078   .2329461     4.30   0.000     .5445124    1.457644
##        _cons |  -2.463577   .8925892    -2.76   0.006     -4.21302   -.7141344
## ------------------------------------------------------------------------------
## 
## .</code></pre>
<p>Note that the use the <code>coef</code> option to get the log odds ratio estimates.</p>
</div>
<div id="r-code-1" class="section level3">
<h3><span class="header-section-number">4.1.2</span> R code</h3>
<pre class="sourceCode r"><code class="sourceCode r">rct &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;stata/rct.dta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">modify_at</span>(<span class="kw">c</span>(<span class="st">&quot;trt&quot;</span>,<span class="st">&quot;catout&quot;</span>), haven<span class="op">::</span>as_factor, <span class="dt">levels =</span> <span class="st">&quot;labels&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">modify_at</span>(<span class="kw">c</span>(<span class="st">&quot;site&quot;</span>,<span class="st">&quot;time&quot;</span>), haven<span class="op">::</span>as_factor)
rct <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(time<span class="op">==</span><span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">glm</span>(catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar , <span class="dt">data=</span>., <span class="dt">family =</span> binomial) <span class="op">%&gt;%</span>
<span class="st">  </span>summary</code></pre>
<pre><code>## 
## Call:
## glm(formula = catout ~ trt + site + covar, family = binomial, 
##     data = .)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9659  -0.5335   0.1943   0.5095   2.8873  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.46358    0.89259  -2.760 0.005780 ** 
## trtActive   -2.89030    0.78502  -3.682 0.000232 ***
## site2        0.77834    0.85802   0.907 0.364337    
## site3        1.42379    0.77865   1.829 0.067470 .  
## site4        0.02532    0.80829   0.031 0.975007    
## covar        1.00108    0.23295   4.297 1.73e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 122.318  on 97  degrees of freedom
## Residual deviance:  73.724  on 92  degrees of freedom
## AIC: 85.724
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Not surprisingly, the estimates are identical.</p>
</div>
<div id="reporting-1" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Reporting</h3>
<p>Reporting for dichotomous endpoints is a bit tricky. The natural estimates from a logistic regression is odds and odds ratios, but these are less interpretable than risk differences or relative risk. As New England Journal of Medicine states in their Statistical Guidelines: “Odds ratios should be avoided, as they may overestimate the relative risks in many settings and be misinterpreted.” Fortunately, both Stata and R can estimate adjusted risk differences and relative risks from logistic regressions.</p>
<div id="stata-code-2" class="section level4">
<h4><span class="header-section-number">4.1.3.1</span> Stata code</h4>
<p>First we compute the average prediced marginal probabilities. Basically this is done by calculating the predicted probability of a positive outcome for each patient, under both treatments, and then averaging. The standard errors are computed by the delta method.</p>
<pre class="stata"><code>use &quot;stata/rct&quot;, clear 
quietly logistic catout i.trt i.site covar  if time==3, coef
margins trt</code></pre>
<pre><code>## 
## . use &quot;stata/rct&quot;, cle(all strata combined)
## 
## . quietly logistic catout i.trt i.site covar  if time==3, coef
## 
## . margins trt
## 
## Predictive margins                              Number of obs     =         98
## Model VCE    : OIM
## 
## Expression   : Pr(catout), predict()
## 
## ------------------------------------------------------------------------------
##              |            Delta-method
##              |     Margin   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##          trt |
##     Placebo  |   .8499905   .0387218    21.95   0.000     .7740972    .9258839
##      Active  |   .5111833   .0533918     9.57   0.000     .4065374    .6158293
## ------------------------------------------------------------------------------
## 
## .</code></pre>
<p>The adjusted risk difference is calculated similarily.</p>
<pre class="stata"><code>use &quot;stata/rct&quot;, clear 
quietly logistic catout i.trt i.site covar  if time==3, coef
margins, dydx(trt)</code></pre>
<pre><code>## 
## . use &quot;stata/rct&quot;, cle(all strata combined)
## 
## . quietly logistic catout i.trt i.site covar  if time==3, coef
## 
## . margins, dydx(trt)
## 
## Average marginal effects                        Number of obs     =         98
## Model VCE    : OIM
## 
## Expression   : Pr(catout), predict()
## dy/dx w.r.t. : 1.trt
## 
## ------------------------------------------------------------------------------
##              |            Delta-method
##              |      dy/dx   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##          trt |
##      Active  |  -.3388072   .0661086    -5.13   0.000    -.4683777   -.2092367
## ------------------------------------------------------------------------------
## Note: dy/dx for factor levels is the discrete change from the base level.
## 
## .</code></pre>
<p>We see that the risk difference is the difference of the estimated marginal probabilities we computed previously.</p>
<p>The relative risk is a bit more difficult to calculate, but not much. It uses the <code>nlcom</code> method to compute non-linear combinations of estimates.</p>
<pre class="stata"><code>use &quot;stata/rct&quot;, clear 
quietly logistic catout i.trt i.site covar  if time==3, coef
quietly margins trt, post
margins, coeflegend
nlcom (ratio1: log(_b[1.trt]/_b[0bn.trt]))</code></pre>
<pre><code>## 
## . use &quot;stata/rct&quot;, cle(all strata combined)
## 
## . quietly logistic catout i.trt i.site covar  if time==3, coef
## 
## . quietly margins trt, post
## 
## . margins, coeflegend
## 
## Predictive margins                              Number of obs     =         98
## Model VCE    : OIM
## 
## Expression   : Pr(catout), predict()
## 
## ------------------------------------------------------------------------------
##              |     Margin  Legend
## -------------+----------------------------------------------------------------
##          trt |
##     Placebo  |   .8499905  _b[0bn.trt]
##      Active  |   .5111833  _b[1.trt]
## ------------------------------------------------------------------------------
## 
## . nlcom (ratio1: log(_b[1.trt]/_b[0bn.trt]))
## 
##       ratio1:  log(_b[1.trt]/_b[0bn.trt])
## 
## ------------------------------------------------------------------------------
##              |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##       ratio1 |  -.5084969   .1141546    -4.45   0.000    -.7322358    -.284758
## ------------------------------------------------------------------------------
## 
## .</code></pre>
<p>The trick is to know what goes into the _b[]-brackets, which will be revealed using the `coeflegend´-option. Note that we use the logarithmic function for stability. To get the relative risk estimates, the results need to be exponentiated. Note that I do not know the properties of this estimator, and it might be clever to check the estimates using bootstrap.</p>
<p>Some journals require calculation of the number needed to treat (NNT), at least if the confidence interval of the adjusted risk difference does not include zero (for which the NNT is undefined). This is simply done by inverting the adjusted risk difference estimate (both point estimate and the confidence limits).</p>
</div>
<div id="r-code-2" class="section level4">
<h4><span class="header-section-number">4.1.3.2</span> R code</h4>
<p>The average predicted marginal probabilities are not easily computed in R. One option is to use the estimated marginal means computed using the <code>emmeans</code>-package:</p>
<pre class="sourceCode r"><code class="sourceCode r">rct <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(time <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">glm</span>(catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar , <span class="dt">data=</span>., <span class="dt">family =</span> binomial) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">emmeans</span>(<span class="st">&quot;trt&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre>
<pre><code>##  trt      prob     SE  df asymp.LCL asymp.UCL
##  Placebo 0.946 0.0343 Inf     0.824     0.985
##  Active  0.492 0.0933 Inf     0.318     0.668
## 
## Results are averaged over the levels of: site 
## Confidence level used: 0.95 
## Intervals are back-transformed from the logit scale</code></pre>
<p>We notice that the estimates are quite different from the average prediced marginal probabilities. The problem also is that the <code>emmeans</code>-package does not present pairwise comparisons on the probability scale.</p>
<p>Another option is to bootstrap the predicted marginal predicitons:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)

 fpred &lt;-<span class="st"> </span><span class="cf">function</span>(formula, data, indices){
   d &lt;-<span class="st"> </span>data[indices,]
   fit &lt;-<span class="st"> </span><span class="kw">glm</span>(formula, <span class="dt">data =</span> d, <span class="dt">family =</span> binomial)
   pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(fit,<span class="dt">data =</span> d, <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Placebo&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">     </span>as_tibble <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">group_by</span>(trt) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(fitted)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">paste0</span>(trt)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">select</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">spread</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span>as_vector
   <span class="kw">return</span>(pred)
 }
 
 data &lt;-<span class="st"> </span><span class="kw">filter</span>(rct, time <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)
 result &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> data, 
                <span class="dt">statistic =</span> fpred, 
                <span class="dt">R =</span> <span class="dv">10000</span>, 
                <span class="dt">formula =</span> catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar,
                <span class="dt">parallel =</span> <span class="st">&quot;multicore&quot;</span>,
                <span class="dt">ncpus =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) 
 
 result <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">select</span>(<span class="op">-</span>bias) <span class="op">%&gt;%</span>
<span class="st">   </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Active
</td>
<td style="text-align:right;">
0.511
</td>
<td style="text-align:right;">
0.067
</td>
<td style="text-align:right;">
0.382
</td>
<td style="text-align:right;">
0.645
</td>
</tr>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
0.850
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.767
</td>
<td style="text-align:right;">
0.928
</td>
</tr>
</tbody>
</table>
<p>We see that the estimates are identical to the Stata estimates, although the standard errors and confidence limits are a bit different.</p>
<p>The estimated marginal risk difference in R is computed using the <code>margins</code>-package.</p>
<pre class="sourceCode r"><code class="sourceCode r"> rlogistic &lt;-<span class="st"> </span>rct <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(time<span class="op">==</span><span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">glm</span>(catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar , <span class="dt">data=</span>., <span class="dt">family =</span> binomial)


  <span class="kw">margins</span>(<span class="dt">model =</span> rlogistic, <span class="dt">variables =</span> <span class="st">&quot;trt&quot;</span>, <span class="dt">data =</span> <span class="kw">filter</span>(rct,time<span class="op">==</span><span class="dv">3</span>), <span class="dt">vce =</span> <span class="st">&quot;delta&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summary</span>()</code></pre>
<pre><code>##     factor     AME     SE       z      p   lower   upper
##  trtActive -0.3388 0.0661 -5.1250 0.0000 -0.4684 -0.2092</code></pre>
<p>We see that the estimates are identical to the Stata estimates.</p>
<p>Risk ratios are definitely not that easily computed in R, probably best done using bootstrapping:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)


 fpred &lt;-<span class="st"> </span><span class="cf">function</span>(formula, data, indices){
   d &lt;-<span class="st"> </span>data[indices,]
   fit &lt;-<span class="st"> </span><span class="kw">glm</span>(formula, <span class="dt">data =</span> d, <span class="dt">family =</span> binomial)
   pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(fit,<span class="dt">data =</span> d, <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Placebo&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">     </span>as_tibble <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">group_by</span>(trt) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(fitted)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">paste0</span>(trt)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">select</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">spread</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span>as_vector
   <span class="kw">return</span>(pred[<span class="st">&quot;Active&quot;</span>]<span class="op">/</span>pred[<span class="st">&quot;Placebo&quot;</span>])
 }
 
 data &lt;-<span class="st"> </span><span class="kw">filter</span>(rct, time <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)
 result &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> data, 
                <span class="dt">statistic =</span> fpred, 
                <span class="dt">R =</span> <span class="dv">10000</span>, 
                <span class="dt">formula =</span> catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar,
                <span class="dt">parallel =</span> <span class="st">&quot;multicore&quot;</span>,
                <span class="dt">ncpus =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) 
 
 result <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">select</span>(<span class="op">-</span>bias) <span class="op">%&gt;%</span>
<span class="st">   </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Active
</td>
<td style="text-align:right;">
0.601
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.448
</td>
<td style="text-align:right;">
0.763
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="repeated-follow-up-1" class="section level2">
<h2><span class="header-section-number">4.2</span> Repeated follow-up</h2>
<p>When there are repeated dichotomous endpoints, there are usually two methods available, either the generalized estimating equations method or the generalized mixed model method. I prefer the mixed model approach because it has better missing data properties, and I like that the parameter estimates are interpretable conditional on the subject. In my mind it is more aligned to a causal interpretation. I will show how to do the mixed logistic regression model. We skip the simple model and go straight to a model with treatment-time interaction. Note that usually a dichotomous endpoint all have the same value at baseline (all subjects are in the same state), thus we rarely include the baseline. The model is a simple random intercept model, but it could of course also be expanded to a random intercept and slope model.</p>
</div>
<div id="treatment-time-interaction-model" class="section level2">
<h2><span class="header-section-number">4.3</span> Treatment-time interaction model</h2>
<p>In Stata, the model is coded as:</p>
<pre class="stata"><code>use &quot;stata/rct&quot;, clear 
bysort time: tabulate catout trt, column
melogit catout i.trt i.site covar i.time i.trt#i.time if time != 0 || pid: </code></pre>
<pre><code>## 
## . use &quot;stata/rct&quot;, cle(all strata combined)
## 
## . bysort time: tabulate catout trt, column
## 
## -------------------------------------------------------------------------------
## -&gt; time = 0
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## -----------+----------------------+----------
##      Total |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## 
## -------------------------------------------------------------------------------
## -&gt; time = 1
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |        24         32 |        56 
##            |     48.00      66.67 |     57.14 
## -----------+----------------------+----------
##   Positive |        26         16 |        42 
##            |     52.00      33.33 |     42.86 
## -----------+----------------------+----------
##      Total |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## 
## -------------------------------------------------------------------------------
## -&gt; time = 2
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |        12         29 |        41 
##            |     24.00      60.42 |     41.84 
## -----------+----------------------+----------
##   Positive |        38         19 |        57 
##            |     76.00      39.58 |     58.16 
## -----------+----------------------+----------
##      Total |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## 
## -------------------------------------------------------------------------------
## -&gt; time = 3
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |         9         22 |        31 
##            |     18.00      45.83 |     31.63 
## -----------+----------------------+----------
##   Positive |        41         26 |        67 
##            |     82.00      54.17 |     68.37 
## -----------+----------------------+----------
##      Total |        50         48 |        98 
##            |    100.00     100.00 |    100.00 
## 
## 
## . melogit catout i.trt i.site covar i.time i.trt#i.time if time != 0 || pid: 
## 
## Fitting fixed-effects model:
## 
## Iteration 0:   log likelihood = -133.59899  
## Iteration 1:   log likelihood = -129.32428  
## Iteration 2:   log likelihood = -129.32244  
## Iteration 3:   log likelihood = -129.32244  
## 
## Refining starting values:
## 
## Grid node 0:   log likelihood = -130.87679
## 
## Fitting full model:
## 
## Iteration 0:   log likelihood = -130.87679  
## Iteration 1:   log likelihood =  -129.7867  
## Iteration 2:   log likelihood = -129.37214  
## Iteration 3:   log likelihood = -129.31054  
## Iteration 4:   log likelihood = -129.31042  
## Iteration 5:   log likelihood = -129.31042  
## 
## Mixed-effects logistic regression               Number of obs     =        294
## Group variable:             pid                 Number of groups  =         98
## 
##                                                 Obs per group:
##                                                               min =          3
##                                                               avg =        3.0
##                                                               max =          3
## 
## Integration method: mvaghermite                 Integration pts.  =          7
## 
##                                                 Wald chi2(9)      =      57.65
## Log likelihood = -129.31042                     Prob &gt; chi2       =     0.0000
## ------------------------------------------------------------------------------
##       catout |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##          trt |
##      Active  |  -1.445692   .5336445    -2.71   0.007    -2.491616   -.3997679
##              |
##         site |
##           2  |  -.0293421   .4666747    -0.06   0.950    -.9440077    .8853234
##           3  |     .72617   .4145006     1.75   0.080    -.0862363    1.538576
##           4  |   .5185491   .4721013     1.10   0.272    -.4067524    1.443851
##              |
##        covar |   .9174909   .1319527     6.95   0.000     .6588684    1.176113
##              |
##         time |
##           2  |   1.787348   .5856394     3.05   0.002     .6395156     2.93518
##           3  |   2.365878   .6353582     3.72   0.000     1.120599    3.611157
##              |
##     trt#time |
##    Active#2  |  -1.406754   .7657322    -1.84   0.066    -2.907561    .0940536
##    Active#3  |  -1.127376    .785537    -1.44   0.151       -2.667    .4122484
##              |
##        _cons |  -4.424402   .7595232    -5.83   0.000     -5.91304   -2.935764
## -------------+----------------------------------------------------------------
## pid          |
##    var(_cons)|   .0684106   .4545936                      1.51e-07    31004.17
## ------------------------------------------------------------------------------
## LR test vs. logistic model: chibar2(01) = 0.02        Prob &gt;= chibar2 = 0.4384
## 
## .</code></pre>
<p>In R, this model is coded as:</p>
<pre class="sourceCode r"><code class="sourceCode r">rct <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(time <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">glmer</span>(catout <span class="op">~</span> trt <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>trt<span class="op">*</span>time <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>pid), 
        <span class="dt">data =</span> ., 
        <span class="dt">family =</span> binomial, 
        <span class="dt">nAGQ =</span> <span class="dv">7</span>)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Adaptive
##   Gauss-Hermite Quadrature, nAGQ = 7) [glmerMod]
##  Family: binomial  ( logit )
## Formula: catout ~ trt + time + trt * time + site + covar + (1 | pid)
##    Data: .
##       AIC       BIC    logLik  deviance  df.resid 
##  280.6208  321.1402 -129.3104  258.6208       283 
## Random effects:
##  Groups Name        Std.Dev.
##  pid    (Intercept) 0.2615  
## Number of obs: 294, groups:  pid, 98
## Fixed Effects:
##     (Intercept)        trtActive            time2            time3  
##        -4.42430         -1.44555          1.78736          2.36563  
##           site2            site3            site4            covar  
##        -0.02945          0.72597          0.51845          0.91748  
## trtActive:time2  trtActive:time3  
##        -1.40683         -1.12716</code></pre>
<div id="reporting-2" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Reporting</h3>
<p>Plotting i Stata</p>
<pre class="stata"><code>use stata/rct, clear 
quietly melogit catout i.trt i.site covar i.time i.trt#i.time if time != 0 || pid: 

*Compute the predictive margins by time and treatment

quietly margins time#trt

*Plot the predictive margins. Note that the arguments after the comma is just to prettify the plot.

marginsplot, graphregion(color(white)) graphregion(color(white)) plotregion(color(white)) ytitle(&quot;Marginal estimates&quot;) ylabel(,nogrid)  legend(region(color(none) lstyle(none)) cols(1) ring(0) bplacement(nwest)) title(&quot;&quot;)
graph export stata/figures/cat_fig1.pdf, replace </code></pre>
<pre><code>## 
## . use stata/rct, cle(all strata combined)
## 
## . quietly melogit catout i.trt i.site covar i.time i.trt#i.time if time != 0 ||
## &gt;  pid: 
## 
## . 
## . *Compute the predictive margins by time and treatment
## 
## . 
## . quietly margins time#trt
## 
## . 
## . *Plot the predictive margins. Note that the arguments after the comma is just
## &gt;  to prettify the plot.
## 
## . 
## . marginsplot, graphregion(color(white)) graphregion(color(white)) plotregion(c
## &gt; olor(white)) ytitle(&quot;Marginal estimates&quot;) ylabel(,nogrid)  legend(region(colo
## &gt; r(none) lstyle(none)) cols(1) ring(0) bplacement(nwest)) title(&quot;&quot;)
## 
##   Variables that uniquely identify margins: time trt
## 
## . graph export stata/figures/cat_fig1.pdf, replace 
## (file stata/figures/cat_fig1.pdf written in PDF format)
## 
## .</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;stata/figures/cat_fig1.pdf&quot;</span>)</code></pre>
<p><embed src="stata/figures/cat_fig1.pdf" /><!-- --></p>
<p>Plotting in R</p>
<pre class="sourceCode r"><code class="sourceCode r"> fpred &lt;-<span class="st"> </span><span class="cf">function</span>(formula, data, indices){
   d &lt;-<span class="st"> </span>data[indices,]
   fit &lt;-<span class="st"> </span><span class="kw">glmer</span>(formula, <span class="dt">data =</span> d, <span class="dt">family =</span> binomial)
   pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(fit,
                      <span class="dt">data =</span> d, 
                      <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;Active&quot;</span>, <span class="st">&quot;Placebo&quot;</span>), <span class="dt">time =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">     </span>as_tibble <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">group_by</span>(trt, time) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(fitted)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">paste0</span>(trt, <span class="st">&quot;/&quot;</span>, time)) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">select</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">spread</span>(name,mean) <span class="op">%&gt;%</span>
<span class="st">     </span>as_vector
  <span class="kw">return</span>(pred)
 }
 
 data &lt;-<span class="st"> </span><span class="kw">filter</span>(rct, time <span class="op">!=</span><span class="st"> </span><span class="dv">0</span> )
 result &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> data, 
                <span class="dt">statistic =</span> fpred, 
                <span class="dt">R =</span> <span class="dv">2000</span>, 
                <span class="dt">formula =</span> catout <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>trt<span class="op">*</span>time <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>covar <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>pid),
                <span class="dt">parallel =</span> <span class="st">&quot;multicore&quot;</span>,
                <span class="dt">ncpus =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) 
 
 result <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">select</span>(<span class="op">-</span>bias) <span class="op">%&gt;%</span>
<span class="st">   </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Active/1
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.186
</td>
<td style="text-align:right;">
0.417
</td>
</tr>
<tr>
<td style="text-align:left;">
Active/2
</td>
<td style="text-align:right;">
0.376
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.248
</td>
<td style="text-align:right;">
0.480
</td>
</tr>
<tr>
<td style="text-align:left;">
Active/3
</td>
<td style="text-align:right;">
0.515
</td>
<td style="text-align:right;">
0.069
</td>
<td style="text-align:right;">
0.381
</td>
<td style="text-align:right;">
0.643
</td>
</tr>
<tr>
<td style="text-align:left;">
Placebo/1
</td>
<td style="text-align:right;">
0.548
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.403
</td>
<td style="text-align:right;">
0.679
</td>
</tr>
<tr>
<td style="text-align:left;">
Placebo/2
</td>
<td style="text-align:right;">
0.791
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
0.711
</td>
<td style="text-align:right;">
0.897
</td>
</tr>
<tr>
<td style="text-align:left;">
Placebo/3
</td>
<td style="text-align:right;">
0.848
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.788
</td>
<td style="text-align:right;">
0.943
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">result <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(term, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;trt&quot;</span>, <span class="st">&quot;time&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">c</span>(<span class="st">&quot;trt&quot;</span>,<span class="st">&quot;time&quot;</span>), factor) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_line</span>(statistic <span class="op">~</span> time, <span class="dt">color =</span> <span class="op">~</span>trt, <span class="dt">group =</span> <span class="op">~</span>trt, 
              <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.04</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_point</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.04</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_errorbar</span>(conf.low <span class="op">+</span><span class="st"> </span>conf.high <span class="op">~</span><span class="st"> </span>time, <span class="dt">color =</span> <span class="op">~</span><span class="st"> </span>trt, 
              <span class="dt">width =</span> <span class="fl">.1</span>, 
              <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.04</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>, 
          <span class="dt">y =</span> <span class="st">&quot;Probability&quot;</span>, 
          <span class="dt">color =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_theme</span>(<span class="kw">theme_classic</span>(), <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;Treatment&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_lims</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</code></pre>
<p><img src="rct-cookbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="continuous-endpoints.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["rct-cookbook.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
