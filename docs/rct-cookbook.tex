\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Analyzing RCTs: A Cookbook},
            pdfauthor={Inge Christoffer Olsen},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Analyzing RCTs: A Cookbook}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Inge Christoffer Olsen}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2019-08-09}

\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{preface}{%
\chapter{Preface}\label{preface}}

Placeholder

\hypertarget{structure-of-the-book}{%
\section{Structure of the book}\label{structure-of-the-book}}

\hypertarget{acknowledgements}{%
\section{Acknowledgements}\label{acknowledgements}}

\hypertarget{intro}{%
\chapter{Introduction}\label{intro}}

Placeholder

\hypertarget{trial-flow}{%
\section{Trial Flow}\label{trial-flow}}

\hypertarget{simulated-dataset}{%
\section{Simulated dataset}\label{simulated-dataset}}

\hypertarget{continuous-endpoints}{%
\chapter{Continuous endpoints}\label{continuous-endpoints}}

Placeholder

\hypertarget{single-follow-up}{%
\section{Single follow-up}\label{single-follow-up}}

\hypertarget{stata-code}{%
\subsection{Stata code}\label{stata-code}}

\hypertarget{r-code}{%
\subsection{R code}\label{r-code}}

\hypertarget{reporting}{%
\subsection{Reporting}\label{reporting}}

\hypertarget{repeated-follow-up}{%
\section{Repeated follow-up}\label{repeated-follow-up}}

\hypertarget{simple-model}{%
\subsection{Simple model}\label{simple-model}}

\hypertarget{model-with-treatment-time-interaction}{%
\subsection{Model with treatment-time interaction}\label{model-with-treatment-time-interaction}}

\hypertarget{model-with-treatment-time-interaction-and-baseline-information}{%
\subsection{Model with treatment-time interaction and baseline information}\label{model-with-treatment-time-interaction-and-baseline-information}}

\hypertarget{dichotomous-endpoints}{%
\chapter{Dichotomous endpoints}\label{dichotomous-endpoints}}

\hypertarget{single-follow-up-1}{%
\section{Single follow-up}\label{single-follow-up-1}}

For a single follow-up assessment of a dichotomous endpoint, the main method I use is a standard logistic regression. Then we can adjust for stratification factors in the randomisation in addition to other pre-specified covariates, both categorical and continuous. In the simulated example, we define that the primary outcome is the dichotomous categorical outcome at time 3. Note that usually the baseline status of all patients are negative for the outcome, so adjusting for baseline is not necessary.

\hypertarget{stata-code-1}{%
\subsection{Stata code}\label{stata-code-1}}

\begin{verbatim}
use "stata/rct", clear 
tabulate catout trt
logistic catout i.trt i.site covar  if time==3, coef
\end{verbatim}

\begin{verbatim}
## 
## . use "stata/rct", cle(all strata combined)
## 
## . tabulate catout trt
## 
## Categorica |       Treatment
##  l outcome |   Placebo     Active |     Total
## -----------+----------------------+----------
##   Negative |        95        131 |       226 
##   Positive |       105         61 |       166 
## -----------+----------------------+----------
##      Total |       200        192 |       392 
## 
## . logistic catout i.trt i.site covar  if time==3, coef
## 
## Logistic regression                             Number of obs     =         98
##                                                 LR chi2(5)        =      48.59
##                                                 Prob > chi2       =     0.0000
## Log likelihood = -36.862204                     Pseudo R2         =     0.3973
## 
## ------------------------------------------------------------------------------
##       catout |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##          trt |
##      Active  |  -2.890301   .7850252    -3.68   0.000    -4.428922   -1.351679
##              |
##         site |
##           2  |   .7783404   .8580245     0.91   0.364    -.9033566    2.460037
##           3  |   1.423791   .7786531     1.83   0.067    -.1023412    2.949923
##           4  |   .0253234   .8082887     0.03   0.975    -1.558893     1.60954
##              |
##        covar |   1.001078   .2329461     4.30   0.000     .5445124    1.457644
##        _cons |  -2.463577   .8925892    -2.76   0.006     -4.21302   -.7141344
## ------------------------------------------------------------------------------
## 
## .
\end{verbatim}

Note that the use the \texttt{coef} option to get the log odds ratio estimates.

\hypertarget{r-code-1}{%
\subsection{R code}\label{r-code-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rct <-}\StringTok{ }\KeywordTok{read_dta}\NormalTok{(}\StringTok{"stata/rct.dta"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{modify_at}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"trt"}\NormalTok{,}\StringTok{"catout"}\NormalTok{), haven}\OperatorTok{::}\NormalTok{as_factor, }\DataTypeTok{levels =} \StringTok{"labels"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{modify_at}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{,}\StringTok{"time"}\NormalTok{), haven}\OperatorTok{::}\NormalTok{as_factor)}
\NormalTok{rct }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(time}\OperatorTok{==}\DecValTok{3}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{glm}\NormalTok{(catout }\OperatorTok{~}\StringTok{ }\NormalTok{trt }\OperatorTok{+}\StringTok{ }\NormalTok{site }\OperatorTok{+}\StringTok{ }\NormalTok{covar , }\DataTypeTok{data=}\NormalTok{., }\DataTypeTok{family =}\NormalTok{ binomial) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{summary}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = catout ~ trt + site + covar, family = binomial, 
##     data = .)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9659  -0.5335   0.1943   0.5095   2.8873  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(>|z|)    
## (Intercept) -2.46358    0.89259  -2.760 0.005780 ** 
## trtActive   -2.89030    0.78502  -3.682 0.000232 ***
## site2        0.77834    0.85802   0.907 0.364337    
## site3        1.42379    0.77865   1.829 0.067470 .  
## site4        0.02532    0.80829   0.031 0.975007    
## covar        1.00108    0.23295   4.297 1.73e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 122.318  on 97  degrees of freedom
## Residual deviance:  73.724  on 92  degrees of freedom
## AIC: 85.724
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

\hypertarget{applications}{%
\chapter{Applications}\label{applications}}

Some \emph{significant} applications are demonstrated in this chapter.

\hypertarget{example-one}{%
\section{Example one}\label{example-one}}

\hypertarget{example-two}{%
\section{Example two}\label{example-two}}

\hypertarget{final-words}{%
\chapter{Final Words}\label{final-words}}

We have finished a nice book.

\bibliography{book.bib,packages.bib}


\end{document}
